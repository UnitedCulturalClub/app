<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="color-scheme" content="dark light" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>Login</title>
    <style type="text/css" media="all">
      @media only screen and (prefers-color-scheme: light) {
        :root {
          --color-text-primary: rgba(0, 0, 0, 1);
          --color-text-secondary: rgba(0, 0, 0, 0.5);
          --color-background: rgba(255, 255, 255, 1);
          --color-on-background: rgba(0, 0, 0, 1);
          --color-devider: rgba(0, 0, 0, 0.1);
        }
      }
      @media only screen and (prefers-color-scheme: dark) {
        :root {
          --color-text-primary: rgba(255, 255, 255, 1);
          --color-text-secondary: rgba(190, 190, 190, 1);
          --color-background: rgba(42, 45, 54, 1);
          --color-on-background: rgba(255, 255, 255, 1);
          --color-devider: rgba(255, 255, 255, 0.1);
        }
      }
      body {
        margin: 0;
        padding: 0;
        font-family: Sans-Serif;
        background-color: var(--color-background);
        display: none;
      }
      body.show {
        display: block;
      }
    </style>
  </head>
  <body>
    <div class="activity-main">
      <a href="/app/signup/">/app/signup/</a>
    </div>
    <script type="text/javascript" charset="utf-8">
      window.addEventListener("DOMContentLoaded", e => {
        const rawStack = sessionStorage.getItem("application.auth.nav.stack");
        const stack = rawStack ? JSON.parse(rawStack) : [];
        if (document.referrer) {
          try {
            const url = new URL(document.referrer);
            const allowed = [window.location.origin, "https://unitedculturalclub.github.io"];
            if (allowed.includes(url.origin)) {
              const path = url.pathname;
              if (stack.length === 0 || stack[stack.length - 1] !== path) stack.push(path);
            }
          } catch {}
        }
        if (stack && stack.length > 0) sessionStorage.setItem("application.auth.nav.stack", JSON.stringify(stack));
        else sessionStorage.removeItem("application.auth.nav.stack");

        const interval = setInterval(() => {
          const rawUser = localStorage.getItem("application.user");
          const user = rawUser ? JSON.parse(rawUser) : null;
          if (user && user.auth?.isLoggedIn) {
            clearInterval(interval);
            const rawStack = sessionStorage.getItem("application.auth.nav.stack");
            const stack = rawStack ? JSON.parse(rawStack) : [];
            if (stack.length > 0) {
              stack.pop();
              if (stack.length > 0) sessionStorage.setItem("application.auth.nav.stack", JSON.stringify(stack));
              else sessionStorage.removeItem("application.auth.nav.stack");
              history.back();
            } else {
              const parts = window.location.pathname.split("/").filter(p => p);
              const basePath = parts.includes("app") ? "/" + parts.slice(0, parts.indexOf("app") + 1).join("/") : "";
              window.location.replace(window.location.origin + basePath + "/index.html");
            }
          }
        }, 1);
      });
      window.addEventListener("pageshow", e => {
        const rawUser = localStorage.getItem("application.user");
        const user = rawUser ? JSON.parse(rawUser) : null;
        if (user && user.auth?.isLoggedIn) {
        } else {
          document.body.classList.add("show");
          const rawStack = sessionStorage.getItem("application.auth.nav.stack");
          const stack = rawStack ? JSON.parse(rawStack) : [];
          if (stack.includes(window.location.pathname)) {
            const newStack = stack.filter(stack => stack !== location.pathname);
            if (newStack.length > 0) sessionStorage.setItem("application.auth.nav.stack", JSON.stringify(newStack));
            else sessionStorage.removeItem("application.auth.nav.stack");
          }
        }
      });
      window.ondblclick = () => {
        const userr = {
          auth: {
            isLoggedIn: true
          },
          account: {
            email: "shubhajit3012@gmail.com"
          },
          device: {
            info: ""
          },
          session: {
            id: ""
          }
        };
        //localStorage.setItem("application.user", JSON.stringify(userr));
      };

      document.querySelector("a").addEventListener("click", e => {
        document.body.classList.remove("show");
      });
    </script>
  </body>
</html>
