<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="color-scheme" content="dark light" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>Login</title>
    <style type="text/css" media="all"></style>
  </head>
  <body>
    <h1>Hello Login</h1>
    <a href="signup.html">signup.html</a>
    <script type="text/javascript" charset="utf-8">
      window.ondblclick = () => {
        const userr = {
          auth: {
            isLoggedIn: true
          },
          account: {
            email: "shubhajit3012@gmail.com"
          },
          device: {
            info: ""
          },
          session: {
            id: ""
          }
        };
        localStorage.setItem("application.user", JSON.stringify(userr));
      };
      window.addEventListener("DOMContentLoaded", e => {
        function getStack() {
          let stack = sessionStorage.getItem("application.auth.nav.stack");
          return stack ? JSON.parse(stack) : [];
        }
        const stack = getStack();
        if (document.referrer) {
          try {
            const url = new URL(document.referrer);
            const allowed = [window.location.origin, "https://unitedculturalclub.github.io"];
            if (allowed.includes(url.origin)) {
              const path = url.pathname;
              if (stack.length === 0 || stack[stack.length - 1] !== path) {
                stack.push(path);
              }
            }
          } catch {}
        }
        if (stack && stack.length > 0) {
          sessionStorage.setItem("application.auth.nav.stack", JSON.stringify(stack));
        } else {
          sessionStorage.removeItem("application.auth.nav.stack");
        }

        const interval = setInterval(() => {
          const rawUser = localStorage.getItem("application.user");
          const user = rawUser ? JSON.parse(rawUser) : null;
          if (user && user.auth?.isLoggedIn) {
            clearInterval(interval);
            const stack = getStack();
            if (stack.length > 0) {
              stack.pop();
              if (stack.length > 0) {
                sessionStorage.setItem("application.auth.nav.stack", JSON.stringify(stack));
              } else {
                sessionStorage.removeItem("application.auth.nav.stack");
              }
              history.back();
            } else {
              const parts = window.location.pathname.split("/").filter(p => p);
              const basePath = parts.includes("app") ? "/" + parts.slice(0, parts.indexOf("app") + 1).join("/") : "";
              window.location.replace(window.location.origin + basePath + "/index.html");
            }
          }
        }, 50);
      });
    </script>
  </body>
</html>

