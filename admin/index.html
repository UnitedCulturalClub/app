<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="color-scheme" content="dark light" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>Dashboard</title>
    <style type="text/css" media="all">
      @media only screen and (prefers-color-scheme: light) {
        :root {
          --color-text-primary: rgba(0, 0, 0, 1);
          --color-text-secondary: rgba(0, 0, 0, 0.5);
          --color-background: rgba(255, 255, 255, 1);
          --color-on-background: rgba(0, 0, 0, 1);
          --color-devider: rgba(0, 0, 0, 0.1);
        }
      }
      @media only screen and (prefers-color-scheme: dark) {
        :root {
          --color-text-primary: rgba(255, 255, 255, 1);
          --color-text-secondary: rgba(190, 190, 190, 1);
          --color-background: rgba(42, 45, 54, 1);
          --color-on-background: rgba(255, 255, 255, 1);
          --color-devider: rgba(255, 255, 255, 0.1);
        }
      }
      /* Regular (400 normal) */
      @font-face {
        font-family: "GoogleSans";
        src: url("/app/assets/fonts/GoogleSans-Regular.ttf") format("truetype");
        font-weight: 400;
        font-style: normal;
      }
      /* Italic (400 italic) */
      @font-face {
        font-family: "GoogleSans";
        src: url("/app/assets/fonts/GoogleSans-Italic.ttf") format("truetype");
        font-weight: 400;
        font-style: italic;
      }
      /* Medium (500 normal) */
      @font-face {
        font-family: "GoogleSans";
        src: url("/app/assets/fonts/GoogleSans-Medium.ttf") format("truetype");
        font-weight: 500;
        font-style: normal;
      }
      /* Medium Italic (500 italic) */
      @font-face {
        font-family: "GoogleSans";
        src: url("/app/assets/fonts/GoogleSans-MediumItalic.ttf") format("truetype");
        font-weight: 500;
        font-style: italic;
      }
      /* Bold (700 normal) */
      @font-face {
        font-family: "GoogleSans";
        src: url("/app/assets/fonts/GoogleSans-Bold.ttf") format("truetype");
        font-weight: 700;
        font-style: normal;
      }
      /* Bold Italic (700 italic) */
      @font-face {
        font-family: "GoogleSans";
        src: url("/app/assets/fonts/GoogleSans-BoldItalic.ttf") format("truetype");
        font-weight: 700;
        font-style: italic;
      }
      body {
        margin: 0;
        padding: 0;
        font-family: GoogleSans;
        background-color: var(--color-background);
      }
      .app {
        width: 100%;
      }
      .app > .side {
        width: 80px;
        height: 100%;
        border-right: 1px solid var(--color-devider);
        background-color: var(--color-background);
        position: fixed;
        top: 0;
        left: 0;
        display: flex;
        flex-direction: column;
        justify-content: space-between;
      }
      .app > .side .header {
        width: 100%;
      }
      .app > .side .header .nav {
        width: 100%;
        padding: 10px 20px;
        box-sizing: border-box;
        display: flex;
      }
      .app > .side .header .nav .hamburg {
        width: 40px;
        height: 40px;
        padding: 8px;
        box-sizing: border-box;
        display: flex;
        flex-direction: column;
        justify-content: center;
        z-index: 2;
      }
      .app > .side .header .nav .hamburg span {
        width: 100%;
        height: 2px;
        border-radius: 100px;
        background-color: var(--color-on-background);
        transition: all 0.1s ease;
      }
      .app > .side .header .nav .hamburg span:nth-child(2) {
        width: 12px;
        margin-top: 5px;
      }
      .app > .side .header .nav .hamburg.active span:nth-child(1) {
        opacity: 0;
        width: 20px;
        transform: rotate(45deg) translate(2.5px, 2.5px);
        animation: fade 0.5s forwards;
      }
      .app > .side .header .nav .hamburg.active span:nth-child(2) {
        opacity: 0;
        width: 20px;
        transform: rotate(-45deg) translate(2.5px, -2.5px);
        animation: fade 0.5s ease forwards;
      }
      .app > .side .header .menu {
        width: 100%;
        height: 100%;
        padding: 60px 28px 0px 28px;
        box-sizing: border-box;
        background-color: var(--color-background);
        position: fixed;
        top: 0;
        left: 0;
        pointer-events: none;
        opacity: 0;
        transition: opacity 0.1s ease;
        z-index: 1;
      }
      .app > .side .header .menu.active {
        pointer-events: auto;
        opacity: 1;
      }
      .app > .side .header .menu-item {
        width: 100%;
        margin: 20px 0;
        color: var(--color-text-primary);
        font-size: 20px;
        font-weight: 500;
        opacity: 0;
      }
      .app > .side .header .menu-item.active {
        font-size: 40px;
      }
      .app > .side .header .menu.active .menu-item {
        opacity: 0;
        animation: fade 0.5s ease forwards;
      }
      @keyframes fade {
        0% {
          opacity: 0;
        }
        50% {
          opacity: 0;
        }
        100% {
          opacity: 1;
        }
      }
      .app > .side .nav {
        width: 100%;
        flex: 1;
        padding: 10px;
        box-sizing: border-box;
        overflow-x: hidden;
      }
      .app > .side .nav-item {
        width: 40px;
        height: 40px;
        margin: 10px;
        display: flex;
        justify-content: center;
        align-items: center;
      }
      .app > .side .nav-icon {
        width: 20px;
        height: 20px;
        color: var(--color-text-secondary);
        fill: var(--color-text-secondary);
      }
      .app > .side .nav-item.active .nav-icon {
        color: var(--color-text-primary);
        fill: var(--color-text-primary);
      }
      .app > .side .nav-icon .ic {
        width: 100%;
        height: 100%;
      }
      .app > .side .nav-icon .ic-solid {
        display: none;
      }
      .app > .side .footer .nav-icon {
        width: 32px;
        height: 32px;
        border-radius: 100%;
        background-color: var(--color-background);
        overflow: hidden;
      }
      .app > .side .footer .nav-item.active .nav-icon {
        border: 2px solid var(--color-background);
        box-sizing: border-box;
        outline: 2px solid var(--color-on-background);
      }
      .app > .side .footer .nav-icon img {
        width: 100%;
        height: 100%;
      }
      .app > .main {
        width: 100%;
        padding-left: 80px;
        box-sizing: border-box;
      }
      .app > .main > .container {
        width: 100%;
      }
      .app > .main > .container > .fragment {
        display: none;
      }
      .app > .main > .container > .fragment.active {
        display: block;
      }
      .dashboard {
        width: 100%;
      }
      .dashboard > .main {
        width: 100%;
      }
      .dashboard > .main > .container {
        width: 100%;
      }
      .dashboard > .main > .container > .fragment {
        display: none;
      }
      .dashboard > .main > .container > .fragment.active {
        display: block;
      }
    </style>
  </head>
  <body>
    <div class="app">
      <div class="side">
        <div class="header">
          <nav class="nav">
            <div class="hamburg">
              <span></span>
              <span></span>
            </div>
          </nav>
          <div class="menu">
            <div class="menu-item">
              <span>Collections</span>
            </div>
            <div class="menu-item">
              <span>Expanses</span>
            </div>
          </div>
        </div>
        <div class="nav">
          <div class="nav-item">
            <div class="nav-icon">
              <div class="ic ic-regular">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                  <g><path d="M7 0H4a4 4 0 0 0-4 4v3a4 4 0 0 0 4 4h3a4 4 0 0 0 4-4V4a4 4 0 0 0-4-4Zm2 7a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2ZM20 0h-3a4 4 0 0 0-4 4v3a4 4 0 0 0 4 4h3a4 4 0 0 0 4-4V4a4 4 0 0 0-4-4Zm2 7a2 2 0 0 1-2 2h-3a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2ZM7 13H4a4 4 0 0 0-4 4v3a4 4 0 0 0 4 4h3a4 4 0 0 0 4-4v-3a4 4 0 0 0-4-4Zm2 7a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2v-3a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2ZM20 13h-3a4 4 0 0 0-4 4v3a4 4 0 0 0 4 4h3a4 4 0 0 0 4-4v-3a4 4 0 0 0-4-4Zm2 7a2 2 0 0 1-2 2h-3a2 2 0 0 1-2-2v-3a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2Z"></path></g>
                </svg>
              </div>
              <div class="ic ic-solid">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
                  <g><path d="M85.333 0h64c47.128 0 85.333 38.205 85.333 85.333v64c0 47.128-38.205 85.333-85.333 85.333h-64C38.205 234.667 0 196.462 0 149.333v-64C0 38.205 38.205 0 85.333 0zM362.667 0h64C473.795 0 512 38.205 512 85.333v64c0 47.128-38.205 85.333-85.333 85.333h-64c-47.128 0-85.333-38.205-85.333-85.333v-64C277.333 38.205 315.538 0 362.667 0zM85.333 277.333h64c47.128 0 85.333 38.205 85.333 85.333v64c0 47.128-38.205 85.333-85.333 85.333h-64C38.205 512 0 473.795 0 426.667v-64c0-47.129 38.205-85.334 85.333-85.334zM362.667 277.333h64c47.128 0 85.333 38.205 85.333 85.333v64C512 473.795 473.795 512 426.667 512h-64c-47.128 0-85.333-38.205-85.333-85.333v-64c-.001-47.129 38.204-85.334 85.333-85.334z"></path></g>
                </svg>
              </div>
            </div>
          </div>
        </div>
        <div class="footer">
          <div class="nav">
            <div class="nav-item">
              <div class="nav-icon">
                <div class="ic">
                  <img src="" alt="" />
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="main">
        <div class="container">
          <div class="fragment dashboard">
            <div class="main">
              <div class="container">
                <div class="fragment">
                  <span>Coll</span>
                </div>
                <div class="fragment">
                  <span>Exp</span>
                </div>
              </div>
            </div>
          </div>
          <div class="fragment">
            <span>Profile</span>
          </div>
        </div>
      </div>
    </div>
    <script type="text/javascript" charset="utf-8">
      window.addEventListener("DOMContentLoaded", e => {
        const hash = new URL(window.location.href).hash.replace(/^#\/?/, "");
        const parts = hash.split("/").filter(Boolean);
        const main = parts[0] || "dashboard";
        if (["dashboard", "profile"].includes(main)) {
          const index = ["dashboard", "profile"].indexOf(main);
          onCreate(index);
        }
      });

      const navItem = document.querySelectorAll(".app > .side .nav-item");
      navItem.forEach((item, index) => {
        item.addEventListener("click", e => {
          if (!item.classList.contains("active")) {
            const fragments = ["dashboard", "profile"];
            if (navItem[0].classList.contains("active")) {
              history.pushState({}, "", `#/${fragments[index]}`);
            } else {
              switch (index) {
                case 0:
                  onBackPressed();
                  break;
              }
              history.replaceState({}, "", `#/${fragments[index]}`);
            }
            onCreate(index);
          } else {
          }
        });
      });

      window.addEventListener("hashchange", e => {
        const oldHash = new URL(e.oldURL).hash.replace(/^#\/?/, "");
        const newHash = new URL(e.newURL).hash.replace(/^#\/?/, "");
        const oldParts = oldHash.split("/").filter(Boolean);
        const newParts = newHash.split("/").filter(Boolean);
        const validPaths = {
          dashboard: { menu: {}, coll: {}, exp: {} },
          updates: {},
          profile: {}
        };
        function isValidRoute(parts, validTree) {
          if (parts.length === 0) return true;
          const [head, ...tail] = parts;
          if (!validTree[head]) return false;
          return isValidRoute(tail, validTree[head]);
        }
        if (["dashboard"].includes(oldParts[0])) {
          const index = ["dashboard"].indexOf(oldParts[0]);
          switch (index) {
            case 0:
              if (["menu"].includes(oldParts[1])) {
                const menu = document.querySelector(".app > .side .header .menu");
                const hamburg = document.querySelector(".app > .side .header .nav .hamburg");
                hamburg.classList.remove("active");
                menu.classList.remove("active");
                document.querySelectorAll(".scrollable").forEach(item => {
                  item.classList.remove("no-scroll");
                });
              }
              break;
          }
        }
        if (["dashboard", "profile"].includes(newParts[0]) && isValidRoute(newParts, validPaths)) {
          const index = ["dashboard", "profile"].indexOf(newParts[0]);
          onCreate(index);
          return;
        }
        if (history.length > 1) history.back();
        else window.location.hash = "#/dashboard/coll";
      });

      function onBackPressed() {
        const ref = document.referrer;
        const canGoBack = ref === "" || ref.includes(location.hostname);
        if (canGoBack) {
          const goBack = () => {
            const hashPath = location.hash.replace(/^#\/?/, "");
            if (hashPath.startsWith("dashboard/") && ["coll", "exp"].includes(hashPath.split("/")[1])) {
              return;
            } else {
              history.back();
              setTimeout(goBack, 100);
            }
          };
          goBack();
        }
      }

      function onCreate(index) {
        const fragments = document.querySelectorAll(".app > .main > .container > .fragment");
        fragments.forEach(fragment => fragment.classList.remove("active"));
        fragments[index].classList.add("active");
        navItem.forEach(item => item.classList.remove("active"));
        navItem[index].classList.add("active");
        switch (index) {
          case 0:
            renderDashboard();
            break;
          case 1:
            //renderProfile();
            break;
        }
      }

      function renderDashboard() {
        const hash = new URL(window.location.href).hash.replace(/^#\/?/, "");
        const parts = hash.split("/").filter(Boolean);
        const sub = parts[1] || "coll";
        if (["menu"].includes(sub)) {
          const menu = document.querySelector(".app > .side .header .menu");
          const hamburg = document.querySelector(".app > .side .header .nav .hamburg");
          hamburg.classList.add("active");
          menu.classList.add("active");
          document.querySelectorAll(".scrollable").forEach(item => {
            item.classList.add("no-scroll");
          });
        } else if (["coll", "exp"].includes(sub)) {
          const index = ["coll", "exp"].indexOf(sub);
          switch (index) {
            case 0:
              if (!history.state) history.replaceState({}, "", "#/dashboard/coll");
              break;
          }
          sessionStorage.setItem("app[0][1][fragment]", ["coll", "exp"][index]);
        }
        const fragment = sessionStorage.getItem("app[0][1][fragment]") || "coll";
        const index = ["coll", "exp"].indexOf(fragment);
        loadFragment(index);
      }

      const menu = document.querySelector(".app > .side .header .menu");
      const hamburg = document.querySelector(".app > .side .header .nav .hamburg");
      hamburg.addEventListener("click", e => {
        if (!menu.classList.contains("active")) {
          history.pushState({}, "", "#/dashboard/menu");
          hamburg.classList.add("active");
          menu.classList.add("active");
          document.body.classList.add("scrollable");
          document.querySelectorAll(".scrollable").forEach(item => {
            item.classList.add("no-scroll");
          });
        } else {
          history.back();
        }
      });

      const menuItem = document.querySelectorAll(".app > .side .header .menu-item");
      menuItem.forEach((item, index) => {
        item.addEventListener("click", e => {
          if (!menuItem[index].classList.contains("active")) {
            const fragments = ["coll", "exp"];
            if (menuItem[0].classList.contains("active")) {
              history.replaceState({}, "", "#/dashboard/exp");
              hamburg.classList.remove("active");
              menu.classList.remove("active");
              document.querySelectorAll(".scrollable").forEach(item => {
                item.classList.remove("no-scroll");
              });
            } else {
              history.go(-2);
            }
            sessionStorage.setItem("app[0][1][fragment]", fragments[index]);
            loadFragment(index);
          } else {
            history.back();
          }
        });
      });

      function loadFragment(index) {
        const fragments = document.querySelectorAll(".dashboard > .main > .container > .fragment");
        fragments.forEach(fragment => fragment.classList.remove("active"));
        fragments[index].classList.add("active");
        const menuItem = document.querySelectorAll(".app > .side .header .menu-item");
        menuItem.forEach(item => item.classList.remove("active"));
        menuItem[index].classList.add("active");
      }
    </script>
  </body>
</html>
